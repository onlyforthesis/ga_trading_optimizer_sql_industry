# 指定股票批次處理使用說明

## 概述
這個工具專門為您提供的49檔重點台股進行批次遺傳演算法優化。

## 包含的股票清單

### 金融股 (14檔)
- 富邦金、國泰金、中信金、兆豐金、玉山金
- 元大金、開發金、華南金、台新金、新光金
- 合庫金、國票金、上海商銀、第一金

### 科技股 (11檔)
- 台積電、鴻海、聯發科、台達電、廣達
- 日月光投控、華碩、聯詠、和碩、研華、緯創

### 傳統產業股 (24檔)
- 台塑、南亞、統一、台泥、亞泥、華新
- 中鋼、大成、中租-KY、遠東新、台塑化
- 台灣大、豐泰、寶成、和泰車、大聯大
- 陽明、萬海、永豐餘、統一超、卜蜂
- 美利達、南電、中保科

## 使用方法

### 方法1：命令行執行
```bash
python run_batch_specific.py
```
- 提供互動式選單
- 可以先檢查股票可用性
- 再執行批次優化

### 方法2：GUI界面
```bash
python main.py
```
然後在瀏覽器中：
1. 打開 http://127.0.0.1:7860
2. 點擊「🔄 批次分析」標籤
3. 在右側「🎯 指定股票批次分析」區域操作

### 方法3：直接調用模組
```python
from batch_specific_stocks import optimize_specific_stocks, check_available_stocks

# 檢查股票可用性
print(check_available_stocks())

# 執行批次優化
print(optimize_specific_stocks())
```

## 功能說明

### 1. 檢查可用股票
- 檢查資料庫中哪些指定股票有資料
- 顯示可用和缺失的股票清單
- 顯示對應的資料表名稱

### 2. 批次優化
- 對所有可用的指定股票進行遺傳演算法優化
- 每檔股票使用5分鐘優化時間
- 自動保存最佳參數到資料庫
- 提供詳細的處理進度和結果

## 優化參數設定

```python
GeneticAlgorithm(
    data, 
    population_size=50,         # 族群大小：50
    generations=100,            # 世代數：100
    max_time_minutes=5.0,       # 每檔股票最多5分鐘
    convergence_threshold=0.001, # 收斂閾值
    convergence_generations=10   # 收斂世代數
)
```

## 結果保存

優化結果會自動保存到資料庫的 `BestParameters` 表格中，包含：
- 股票代碼和名稱
- 所屬產業
- 最佳參數（間隔天數、持有天數、目標獲利率、Alpha值）
- 績效指標（總收益、勝率、最大回撤、夏普比率、適應度）
- 處理時間

## 預估執行時間

- 檢查股票可用性：< 1分鐘
- 批次優化：約 4-5 小時（假設49檔股票都可用，每檔5分鐘）

## 注意事項

1. **執行時間較長**：完整批次處理可能需要數小時，建議在閒置時間執行
2. **資料庫連接**：確保SQL Server服務正在運行
3. **中斷恢復**：如果中途中斷，已處理的股票結果會保存在資料庫中
4. **資源使用**：處理過程會佔用較多CPU資源

## 故障排除

### 常見問題
1. **"資料庫未連接"**
   - 檢查SQL Server服務是否運行
   - 確認資料庫連接設定

2. **"股票資料不足"**
   - 某些股票可能資料量不足（少於50筆）
   - 這些股票會被自動跳過

3. **"模組導入失敗"**
   - 確認所有必要的Python模組已安裝
   - 運行 `pip install -r requirements.txt`

### 查看結果
處理完成後，可以使用以下方式查看結果：
- GUI界面的「🔍 系統狀態」標籤
- 直接查詢資料庫的 `BestParameters` 表格
- 使用 `check_bestparams_table.py` 腳本

## 檔案說明

- `batch_specific_stocks.py`：核心批次處理邏輯
- `run_batch_specific.py`：命令行執行器
- `full_gui.py`：GUI界面（已整合指定股票批次功能）
- `BATCH_SPECIFIC_STOCKS_README.md`：本說明文件
